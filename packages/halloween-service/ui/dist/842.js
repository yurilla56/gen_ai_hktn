"use strict";(self.webpackChunkhalloween_app=self.webpackChunkhalloween_app||[]).push([[842],{3842:(Q,d,r)=>{r.r(d),r.d(d,{DressCheckerModule:()=>U});var c=r(177),m=r(5574),e=r(7705),v=r(4183),f=r(6011),_=r(4412),C=r(8359),g=r(2920),p=r(6038),h=r(203);const k=["camera"],b=["canvas"];function x(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",8)(1,"div",9),e.nrm(2,"img",10),e.k0s(),e.j41(3,"div",11),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleCamera())}),e.j41(4,"span"),e.EFF(5,"Turn On Camera"),e.k0s()()()}}function D(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",12)(1,"div",13),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.takePhoto())}),e.nrm(2,"img",14),e.k0s(),e.j41(3,"div",13),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleCamera())}),e.nrm(4,"img",15),e.k0s()()}}const $=function(n){return{"photo-taken":n}};let O=(()=>{class n{constructor(){this.sendImageData=new e.bkB,this.renderer=(0,e.WQX)(e.sFG),this.cdr=(0,e.WQX)(e.gRc),this.isCameraOpen=!1,this.isPhotoTaken=!1}toggleCamera(){this.isCameraOpen?this.stopCamera():this.startCamera(),this.isCameraOpen=!this.isCameraOpen,this.cdr.detectChanges()}startCamera(){navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{this.stream=t,this.renderer.setProperty(this.camera.nativeElement,"srcObject",t),this.renderer.listen(this.camera.nativeElement,"loadedmetadata",()=>{})}).catch(t=>alert("Camera error: "+t))}stopCamera(){this.stream&&(this.stream.getTracks().forEach(t=>t.stop()),this.renderer.setProperty(this.camera.nativeElement,"srcObject",null))}takePhoto(){if(!this.isCameraOpen)return void alert("Camera is not open");const t=this.canvas?.nativeElement.getContext("2d");if(!t)return void alert("Failed to get canvas context");const s=this.camera.nativeElement;this.canvas.nativeElement.width=s.videoWidth,this.canvas.nativeElement.height=s.videoHeight,t.drawImage(s,0,0,this.canvas.nativeElement.width,this.canvas.nativeElement.height);const i=this.canvas.nativeElement.toDataURL("image/png");this.sendImageData.emit(i.split(",")[1]),this.isPhotoTaken=!0}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-camera"]],viewQuery:function(s,i){if(1&s&&(e.GBs(k,5),e.GBs(b,5)),2&s){let o;e.mGM(o=e.lsd())&&(i.camera=o.first),e.mGM(o=e.lsd())&&(i.canvas=o.first)}},outputs:{sendImageData:"sendImageData"},decls:8,vars:9,consts:[[1,"wrapper",3,"ngClass"],[1,"video-container"],["autoplay","","playsinline","",1,"camera-video"],["camera",""],[1,"canvas-photo"],["canvas",""],["class","show-camera",4,"ngIf"],["class","interactive-buttons",4,"ngIf"],[1,"show-camera"],[1,"no-camera-btn"],["src","../../../assets/no-photography.svg","title","Turn On Camera"],[1,"turn-on-camera-btn",3,"click"],[1,"interactive-buttons"],[1,"take-photo",3,"click"],["src","../../../assets/camera-btn.png","alt","Snap!"],["src","../../../assets/no-photography.svg","title","Toggle Camera On/Off",2,"color","white"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"video",2,3)(4,"canvas",4,5),e.k0s(),e.DNE(6,x,6,0,"div",6),e.DNE(7,D,5,0,"div",7),e.k0s()),2&s&&(e.Y8G("ngClass",e.eq3(7,$,i.isPhotoTaken)),e.R7$(2),e.xc7("display",i.isCameraOpen?"block":"none"),e.R7$(2),e.xc7("display",i.isPhotoTaken?"block":"none"),e.R7$(2),e.Y8G("ngIf",!i.isCameraOpen),e.R7$(1),e.Y8G("ngIf",i.isCameraOpen))},dependencies:[c.YU,c.bT,p.PW],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background-color:#ebedf5}.video-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}.video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%], .video-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.show-camera[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;text-align:center}.turn-on-camera-btn[_ngcontent-%COMP%]{cursor:pointer;background:#3f0f9e;border-radius:40px;padding:1em 2em}.turn-on-camera-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:1.2em}.interactive-buttons[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:50%;transform:translate(-50%);display:flex;gap:32px}.interactive-buttons[_ngcontent-%COMP%]   .take-photo[_ngcontent-%COMP%], .interactive-buttons[_ngcontent-%COMP%]   .microphone[_ngcontent-%COMP%]{cursor:pointer;width:120px;height:120px}.canvas-photo[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.photo-taken[_nghost-%COMP%]   .canvas-photo[_ngcontent-%COMP%], .photo-taken   [_nghost-%COMP%]   .canvas-photo[_ngcontent-%COMP%]{display:block}"],changeDetection:0})}}return n})();const P=["backgroundAudio"];function y(n,a){if(1&n&&(e.qex(0),e.j41(1,"div",11)(2,"video",12),e.nrm(3,"source",13),e.EFF(4," Your browser does not support the video tag. "),e.k0s()(),e.bVm()),2&n){const t=e.XpG().ngIf,s=e.XpG();e.R7$(3),e.Y8G("src",s.baseUrl+t,e.B4B)}}function M(n,a){if(1&n&&e.nrm(0,"img",14),2&n){const t=e.XpG().ngIf,s=e.XpG();e.Y8G("src",s.baseUrl+t,e.B4B)}}function w(n,a){1&n&&(e.j41(0,"span",23),e.EFF(1,"There are no matching clothing items. Tap when completely dressed"),e.k0s())}const u=function(n){return{visible:n}};function j(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"mat-icon",19),e.EFF(2,"checkroom"),e.k0s(),e.j41(3,"div",20),e.bIt("mouseenter",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.noElementsHovered=!0)})("mouseleave",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.noElementsHovered=!1)})("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.toggleCompleteDress())}),e.nrm(4,"img",21),e.DNE(5,w,2,0,"span",22),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("ngClass",e.eq3(2,u,t.noElementsHovered)),e.R7$(1),e.Y8G("ngIf",t.noElementsHovered)}}function I(n,a){1&n&&(e.qex(0),e.j41(1,"div",27),e.nrm(2,"img",28),e.k0s(),e.bVm())}function G(n,a){1&n&&(e.j41(0,"span",30),e.EFF(1,"Tap when dressed"),e.k0s())}function E(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",20),e.bIt("mouseenter",function(){e.eBV(t);const i=e.XpG().$implicit,o=e.XpG(3);return e.Njj(o.hoveredElement=i)})("mouseleave",function(){e.eBV(t);const i=e.XpG(4);return e.Njj(i.hoveredElement=null)})("click",function(){e.eBV(t);const i=e.XpG().$implicit,o=e.XpG(3);return e.Njj(o.toggleDress(i))}),e.nrm(1,"img",21),e.DNE(2,G,2,0,"span",29),e.k0s()}if(2&n){const t=e.XpG().$implicit,s=e.XpG(3);e.R7$(1),e.Y8G("ngClass",e.eq3(2,u,s.hoveredElement===t)),e.R7$(1),e.Y8G("ngIf",s.hoveredElement===t)}}function T(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"img",25),e.bIt("click",function(){const o=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.toggleDress(o))}),e.k0s(),e.DNE(2,I,3,0,"ng-container",0),e.DNE(3,E,3,4,"div",26),e.k0s()}if(2&n){const t=a.$implicit;e.R7$(1),e.Y8G("src","../../assets/"+t.image,e.B4B),e.R7$(1),e.Y8G("ngIf",t.isDressedOn),e.R7$(1),e.Y8G("ngIf",!1===t.isDressedOn||void 0===t.isDressedOn)}}function V(n,a){if(1&n&&(e.qex(0),e.j41(1,"div",15),e.DNE(2,j,6,4,"div",16),e.nI1(3,"async"),e.DNE(4,T,4,3,"div",17),e.nI1(5,"async"),e.k0s(),e.bVm()),2&n){const t=e.XpG(2);let s;e.R7$(2),e.Y8G("ngIf",!(null!=(s=e.bMT(3,2,t.elements$))&&s.length)),e.R7$(2),e.Y8G("ngForOf",e.bMT(5,4,t.elements$))}}const B=function(n){return{muted:n}};function R(n,a){if(1&n){const t=e.RV6();e.qex(0),e.nrm(1,"audio",31,32),e.j41(3,"div",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.toggleMute())}),e.j41(4,"mat-icon"),e.EFF(5),e.k0s()(),e.bVm()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("muted",t.isMuted),e.R7$(2),e.Y8G("ngClass",e.eq3(3,B,t.isMuted)),e.R7$(2),e.JRh(t.isMuted?"volume_off":"volume_up")}}function X(n,a){if(1&n){const t=e.RV6();e.j41(0,"img",35),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.hide())}),e.k0s()}}function N(n,a){if(1&n&&(e.qex(0),e.DNE(1,X,1,0,"img",34),e.bVm()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.isBrilliantVisible)}}function Y(n,a){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",1),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.goBack())}),e.nrm(2,"img",2),e.k0s(),e.j41(3,"div",3)(4,"div",4),e.DNE(5,y,5,1,"ng-container",5),e.DNE(6,M,1,1,"ng-template",null,6,e.C5r),e.DNE(8,V,6,6,"ng-container",0),e.nI1(9,"async"),e.k0s(),e.j41(10,"div",7)(11,"div",8)(12,"div",9)(13,"app-camera",10),e.bIt("sendImageData",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.getImageData(i))}),e.k0s()()()()(),e.DNE(14,R,6,5,"ng-container",0),e.nI1(15,"async"),e.DNE(16,N,2,1,"ng-container",0),e.nI1(17,"async"),e.bVm()}if(2&n){const t=a.ngIf,s=e.sdS(7),i=e.XpG();e.R7$(5),e.Y8G("ngIf",t.endsWith(".mp4"))("ngIfElse",s),e.R7$(3),e.Y8G("ngIf",e.bMT(9,5,i.elements$)),e.R7$(6),e.Y8G("ngIf",e.bMT(15,7,i.audioPath$)),e.R7$(2),e.Y8G("ngIf",e.bMT(17,9,i.allDressed$))}}const F=[{path:"",component:(()=>{class n{constructor(){this.route=(0,e.WQX)(m.nX),this.nodeApiService=(0,e.WQX)(v.c),this.storageService=(0,e.WQX)(f.n),this.cdr=(0,e.WQX)(e.gRc),this.router=(0,e.WQX)(m.Ix),this.dressPath$$=new _.t(null),this.dressPath$=this.dressPath$$.asObservable(),this.audioPath$$=new _.t(null),this.audioPath$=this.audioPath$$.asObservable(),this.elements$$=new _.t(null),this.elements$=this.elements$$.asObservable(),this.allDressed$$=new _.t(!1),this.allDressed$=this.allDressed$$.asObservable(),this.baseUrl="../../assets/",this.isMuted=!1,this.hoveredElement=null,this.noElementsHovered=!1,this.isBrilliantVisible=!0,this.subscription=new C.yU}ngOnInit(){const t=this.route.snapshot.queryParams.animal,s=this.route.snapshot.queryParams.costume;t&&s&&(this.nodeApiService.getDress(t,s),this.nodeApiService.getCostumeElements(s)),this.nodeApiService.getDressAudio(),this.subscription.add(this.storageService.dress$.subscribe(i=>{this.dressPath$$.next(i)})),this.subscription.add(this.storageService.dressAudio$.subscribe(i=>{this.audioPath$$.next(i)})),this.subscription.add(this.storageService.elements$.subscribe(i=>{const o=i?.map(l=>({image:l}))||[];this.elements$$.next(o)})),this.subscription.add(this.elements$.subscribe(i=>{if(i&&i.length>0){const o=i.every(l=>l.isDressedOn);this.allDressed$$.next(o)}else this.allDressed$$.next(!1)}))}ngAfterViewInit(){this.subscription.add(this.audioPath$.subscribe(t=>{this.backgroundAudio&&this.backgroundAudio.nativeElement&&(this.backgroundAudio.nativeElement.src=`../../assets/${t}`,this.backgroundAudio.nativeElement.volume=this.isMuted?0:.05,t&&this.backgroundAudio.nativeElement.play().catch(s=>{console.error(s)}),this.cdr.detectChanges())}))}toggleMute(){this.isMuted=!this.isMuted,this.backgroundAudio&&this.backgroundAudio.nativeElement&&(this.backgroundAudio.nativeElement.volume=this.isMuted?0:.05,this.cdr.detectChanges())}toggleDress(t){t.isDressedOn=!t.isDressedOn;const s=this.elements$$.getValue()||[],i=s.findIndex(o=>o.image===t.image);if(-1!==i&&(s[i]={...s[i],isDressedOn:t.isDressedOn},this.elements$$.next(s)),s.length>0){const o=s.every(l=>l.isDressedOn);this.allDressed$$.next(o)}else this.allDressed$$.next(!1)}goBack(){this.router.navigate(["/costumes"],{queryParams:{name:this.route.snapshot.queryParams.animal}})}toggleCompleteDress(){const t=this.allDressed$$.getValue();this.allDressed$$.next(!t)}hide(){this.isBrilliantVisible=!1}getImageData(t){}resetDress(){this.storageService.dress$$.next(null),this.storageService.elements$$.next(null),this.dressPath$$.next(null),this.elements$$.next(null)}ngOnDestroy(){this.resetDress(),this.subscription.unsubscribe()}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-dress-checker"]],viewQuery:function(s,i){if(1&s&&e.GBs(P,5),2&s){let o;e.mGM(o=e.lsd())&&(i.backgroundAudio=o.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[1,"arrow-back",3,"click"],["src","../../assets/arrow-back.svg","alt","Back"],["fxLayout","row","fxFlex","100%",1,"wrapper"],["fxFlex","50%",1,"image-wrapper"],[4,"ngIf","ngIfElse"],["imageTemplate",""],["fxFlex","50%"],[1,"camera-block"],[1,"camera"],[3,"sendImageData"],[1,"video-container"],["width","100%","height","auto","autoplay","","loop","","muted","","playsinline",""],["type","video/mp4",3,"src"],["width","100%","alt","Dress Image",3,"src"],[1,"elements-wrapper"],["class","no-elements-container",4,"ngIf"],["class","element-container",4,"ngFor","ngForOf"],[1,"no-elements-container"],[1,"no-elements-icon"],[1,"overlay",3,"mouseenter","mouseleave","click"],["src","../../assets/checked.svg","alt","Checked",1,"hover-checkmark",3,"ngClass"],["class","tooltip","style","width: 215px; word-break: break-word; white-space: normal; text-align: center; bottom: 0;",4,"ngIf"],[1,"tooltip",2,"width","215px","word-break","break-word","white-space","normal","text-align","center","bottom","0"],[1,"element-container"],["alt","Costume Element",1,"element-image",3,"src","click"],["class","overlay",3,"mouseenter","mouseleave","click",4,"ngIf"],[1,"checkmark-container"],["src","../../assets/checked.svg","alt","Checked",1,"checkmark"],["class","tooltip",4,"ngIf"],[1,"tooltip"],["autoplay","","loop","",3,"muted"],["backgroundAudio",""],[1,"sound-icon",3,"ngClass","click"],["src","../../assets/brilliant.png","class","brilliant-image","alt","Brilliant",3,"click",4,"ngIf"],["src","../../assets/brilliant.png","alt","Brilliant",1,"brilliant-image",3,"click"]],template:function(s,i){1&s&&(e.DNE(0,Y,18,11,"ng-container",0),e.nI1(1,"async")),2&s&&e.Y8G("ngIf",e.bMT(1,1,i.dressPath$))},dependencies:[c.YU,c.Sq,c.bT,g.DJ,g.UI,p.PW,h.An,O,c.Jj],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;width:100%}.image-wrapper[_ngcontent-%COMP%]{position:relative;height:auto}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{image-rendering:auto}.video-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100vh;overflow:hidden}.video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:auto}.elements-wrapper[_ngcontent-%COMP%]{position:absolute;bottom:5px;display:flex;flex-wrap:wrap;justify-content:center;gap:10px;width:100%}.element-image[_ngcontent-%COMP%]{image-rendering:auto;width:173px;height:173px;background:rgba(255,255,255,.7);box-sizing:border-box;border-radius:4px;box-shadow:0 4px 15px #0000004d;transition:box-shadow .4s ease-in-out}.element-image[_ngcontent-%COMP%]:hover{cursor:pointer;box-shadow:0 8px 20px #00000080}.element-container[_ngcontent-%COMP%]{position:relative}.overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;transition:background .3s}.overlay[_ngcontent-%COMP%]:hover{cursor:pointer;background:rgba(238,174,255,.5)}.overlay[_ngcontent-%COMP%]:hover   .hover-checkmark[_ngcontent-%COMP%]{display:block;filter:grayscale(100%)}.hover-checkmark[_ngcontent-%COMP%]{display:none}.tooltip[_ngcontent-%COMP%]{position:absolute;background:rgba(0,0,0,.7);color:#fff;padding:5px;border-radius:4px;white-space:nowrap;font-size:12px;transform:translate(-50%);margin-bottom:5px;bottom:10%;left:50%}.checkmark-container[_ngcontent-%COMP%]{position:absolute;top:-2%;right:20%;width:24px;height:24px}.brilliant-image[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);opacity:0;animation:_ngcontent-%COMP%_fadeGrow 1s forwards}@keyframes _ngcontent-%COMP%_fadeGrow{0%{opacity:0;transform:translate(-50%,-50%) scale(.5)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}.no-elements-container[_ngcontent-%COMP%]{position:relative;width:173px;height:173px;display:flex;align-items:flex-start;justify-content:center;background-color:#f0f0f0;border:2px solid #ddd;border-radius:8px;cursor:pointer;transition:transform .2s ease-in-out;opacity:.7}.no-elements-container[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.no-elements-icon[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;width:80px;height:80px;font-size:60px;color:#2f4f4f}.no-elements-icon[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out}.no-elements-icon[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .hover-checkmark[_ngcontent-%COMP%]{width:24px;margin-bottom:8px}.no-elements-icon[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{color:#fff;font-size:12px;width:80px;text-align:center;word-wrap:break-word;white-space:normal;max-width:215px;bottom:0}.no-elements-container[_ngcontent-%COMP%]:hover   .no-elements-icon[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:1}.camera-block[_ngcontent-%COMP%], .camera-block[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})()}];let A=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[m.iI.forChild(F),m.iI]})}}return n})();var S=r(6924);let U=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[c.MD,S.YF,A,h.m_]})}}return n})()}}]);